<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252" /><link rel="stylesheet" href="file:///C:\Archivos de programa\MATLAB\R2009a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /><title>Function details for evalu</title><link rel="stylesheet" href="file:///C:\Archivos de programa\MATLAB\R2009a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">evalu (1 call, 59.672 sec)</span><br/><i>Generated 07-Apr-2010 22:08:56 using cpu time.</i><br/>M-script in file D:\membrane_tracking_project\program\evalu.m<br/>Copy to new window for comparing multiple runs<p><span class="warning">This function changed during profiling or before generation of this report. Results may be incomplete or inaccurate.</span></p><div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/> No parent <div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line76">76</a></td><td class="td-linebottomrt"><pre>mempos = load('camino');</pre></td><td class="td-linebottomrt">220</td><td class="td-linebottomrt">13.092 s</td><td class="td-linebottomrt" class="td-linebottomrt">21.9%</td><td class="td-linebottomrt"><img src="file:///C:\Archivos de programa\MATLAB\R2009a\toolbox\matlab\codetools\private\one-pixel.gif" width=22 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line53">53</a></td><td class="td-linebottomrt"><pre>end</pre></td><td class="td-linebottomrt">220</td><td class="td-linebottomrt">9.687 s</td><td class="td-linebottomrt" class="td-linebottomrt">16.2%</td><td class="td-linebottomrt"><img src="file:///C:\Archivos de programa\MATLAB\R2009a\toolbox\matlab\codetools\private\one-pixel.gif" width=16 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line228">228</a></td><td class="td-linebottomrt"><pre>tmp = (mempos(i,1) * sin(n*mem...</pre></td><td class="td-linebottomrt">4705300</td><td class="td-linebottomrt">4.596 s</td><td class="td-linebottomrt" class="td-linebottomrt">7.7%</td><td class="td-linebottomrt"><img src="file:///C:\Archivos de programa\MATLAB\R2009a\toolbox\matlab\codetools\private\one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line205">205</a></td><td class="td-linebottomrt"><pre>tmp = (mempos(i,1) * cos(n*mem...</pre></td><td class="td-linebottomrt">4705300</td><td class="td-linebottomrt">4.155 s</td><td class="td-linebottomrt" class="td-linebottomrt">7.0%</td><td class="td-linebottomrt"><img src="file:///C:\Archivos de programa\MATLAB\R2009a\toolbox\matlab\codetools\private\one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line316">316</a></td><td class="td-linebottomrt"><pre>save(sprintf('%s/results/fluct...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">3.719 s</td><td class="td-linebottomrt" class="td-linebottomrt">6.2%</td><td class="td-linebottomrt"><img src="file:///C:\Archivos de programa\MATLAB\R2009a\toolbox\matlab\codetools\private\one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">24.423 s</td><td class="td-linebottomrt">40.9%</td><td class="td-linebottomrt"><img src="file:///C:\Archivos de programa\MATLAB\R2009a\toolbox\matlab\codetools\private\one-pixel.gif" width=41 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">59.672 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file2.html">num2cell</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\Archivos de programa\MATLAB\R2009a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">59.672 s</td><td class="td-linebottomrt">100.0%</td><td class="td-linebottomrt"><img src="file:///C:\Archivos de programa\MATLAB\R2009a\toolbox\matlab\codetools\private\one-pixel.gif" width=100 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">59.672 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line51">51</a></td><td class="td-linebottomrt"><span class="mono">EXIST with two input arguments is generally faster and clearer than with one input argument.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line75">75</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'camino' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line156">156</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'camino' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line165">165</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'tmp' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line200">200</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'tmp' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line223">223</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'tmp' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line269">269</a></td><td class="td-linebottomrt"><span class="mono">The variable 'savedcontours' appears to change size on every loop iteration (within a script). Consider preallocating for speed.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">462</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">290</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">172</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">154</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">18</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">89.53 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #228B22; background: #FFFFFF;">% this program takes the tracked position of the membrane saved by the </span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">% 'testcontourprogram.m' program and evaluates them </span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.17 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">   4</span> <span style="color: #000000; background: #FFFFFF;">clear all; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">   5</span> <span style="color: #000000; background: #FFFFFF;">fid1=fopen('resultsdesv.txt','w+'); </span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">% sets folder of the program file to have relative paths for the other *.ini</span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">% files</span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">% for linux</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">   9</span> <span style="color: #000000; background: #FFFFFF;">fid = fopen('config/program_directory_path.ini','rt'); </span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">% fid = fopen('/media/daw/home/micha/membrane_tracking_project/medidas/filename.txt','rt');</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  11</span> <span style="color: #000000; background: #FFFFFF;">program_directory_path = fscanf(fid,'%s'); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  12</span> <span style="color: #000000; background: #FFFFFF;">fclose('all'); </span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">% read working directory from config file 'working_directory_path.ini'</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  15</span> <span style="color: #000000; background: #FFFFFF;">fid = fopen(sprintf('%s/config/working_directory_path.ini',program_directory_path),'rt'); </span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">% fid = fopen('/media/daw/home/micha/membrane_tracking_project/medidas/workingdirectory.txt','rt');</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  17</span> <span style="color: #000000; background: #FFFFFF;">working_directory_path = fscanf(fid,'%s'); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  18</span> <span style="color: #000000; background: #FFFFFF;">fclose('all'); </span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">% paramters:</span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">% nmax = 100; % maximal index of the coefficients of the fouriertransformation to be calculated</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">% maxc = 1; % maximum value permited for the coefficients c(n); if a contour give larger value, it will be deleted</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">% resolution = 14e-8; %0.0000001; % this parameter gives the resolution of the microscope (meters per pixel)</span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">% load the parameters of from the configuration file</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  26</span> <span style="color: #000000; background: #FFFFFF;">fid = fopen(sprintf('%s/config/temp_config.ini',program_directory_path)); </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  27</span> <span style="color: #000000; background: #FFFFFF;">c = textscan(fid, '%s = %f %*[^\n]'); % loads config into the cell 'c' </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  28</span> <span style="color: #000000; background: #FFFFFF;">fclose(fid); </span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">% convert the cell 'c' to the structure 'parameterStruct'</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  31</span> <span style="color: #000000; background: #FFFFFF;">parameterStruct = cell2struct(<a href="file2.html">num2cell</a>(c{2}),c{1}); </span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">% output of parameters</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  34</span> <span style="color: #000000; background: #FFFFFF;">parameterStruct; </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  35</span> <span style="color: #000000; background: #FFFFFF;">mkdir(sprintf('%s/memposs',working_directory_path)); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  36</span> <span style="color: #000000; background: #FFFFFF;">q=0; </span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">% variables:</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">% L:    this variable holds the length of the circumference of the vesicle</span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">% memposlength: this variable hold the length of the mempos vector of the</span><br/>               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;">%               vesicles</span><br/>               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;">% ds:   this vector holds the distances between the membrane points along the</span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;">%       membrane</span><br/>               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;">% sumds: this vector is the pairwise sum of the vector ds (i.e.: ds(i) + ds(i + 1));</span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">%        it is used to calculate the center coordinates (x_c,y_c)</span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">% center: this vector holds the coordinates of the center; i.e.: center = (x_c,y_c)</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">% check number of tracked contour files in the contour directory</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  50</span> <span style="color: #000000; background: #FFFFFF;">contournr = 1; </span><br/><a name="Line51"></a><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  51</span> <span style="color: #000000; background: #FFFFFF;">while exist(sprintf('%s/contours/contour%d.txt',working_directory_path,contournr)) == 2 </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  52</span> <span style="color: #000000; background: #FFFFFF;">   contournr = contournr + 1;  </span><br/><span style="color: #FF0000">  9.69 </span><span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  53</span> <a name="Line53"></a><span style="color: #000000; background: #FF9C9C;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  54</span> <span style="color: #000000; background: #FFFFFF;">contournr = contournr - 1; </span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">% PARAMETERS:</span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">% loads file containing the indexes of the saved and deleted contours</span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  59</span> <span style="color: #000000; background: #FFFFFF;">savedcontours = load(sprintf('%s/results/savedcontours.txt',working_directory_path)); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  60</span> <span style="color: #000000; background: #FFFFFF;">deletedcontours = load(sprintf('%s/results/deletedcontours.txt',working_directory_path)); </span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">% this sets the index of 'deletedcontourscounter' so that deleted contours</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;">% will be add to the vector 'deletedcontours'</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  64</span> <span style="color: #000000; background: #FFFFFF;">deletedcontourscounter = length(deletedcontours); </span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  66</span> <span style="color: #000000; background: #FFFFFF;">a = zeros(parameterStruct.nmax,contournr); % coefficients of the fouriertransformation </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  67</span> <span style="color: #000000; background: #FFFFFF;">b = zeros(parameterStruct.nmax,contournr);  </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  68</span> <span style="color: #000000; background: #FFFFFF;">c = zeros(parameterStruct.nmax,contournr); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  69</span> <span style="color: #000000; background: #FFFFFF;">r0 = zeros(1,contournr); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  70</span> <span style="color: #000000; background: #FFFFFF;">wavenumbers = zeros(1,parameterStruct.nmax); % vector holding the wavenumbers </span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  73</span> <span style="color: #000000; background: #FFFFFF;">for j = savedcontours </span><br/>               <span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF;">% load contour</span><br/><a name="Line75"></a>               <span style="color: #A0A0A0">  75</span> <span style="color: #A0A0A0; background: #FFFFFF;">camino=sprintf('%s/contours/contour%i.txt',working_directory_path,j);</span><br/><span style="color: #FF0000"> 13.09 </span><span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  76</span> <a name="Line76"></a><span style="color: #000000; background: #FF8080;">mempos = load('camino'); </span><br/>               <span style="color: #A0A0A0">  77</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF;">% VARIABLES:</span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  80</span> <span style="color: #000000; background: #FFFFFF;">L = 0; % length of circumference </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  81</span> <span style="color: #000000; background: #FFFFFF;">memposlength = length(mempos); % length of the vector mempos </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  82</span> <span style="color: #000000; background: #FFFFFF;">mempospol = zeros(memposlength,2); % vector containing the membrane position in polar coordinates </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  83</span> <span style="color: #000000; background: #FFFFFF;">ds = zeros(memposlength,1); % vector containing the distances between neighbooring membrane positions </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  84</span> <span style="color: #000000; background: #FFFFFF;">sumds = zeros(memposlength,1); % vector containing sum between ds(i) and ds(i + 1) </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  85</span> <span style="color: #000000; background: #FFFFFF;">center = zeros(1,2); % center of the vesicle </span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #228B22; background: #FFFFFF;">% calculate length of circumference</span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  89</span> <span style="color: #000000; background: #FFFFFF;">for i = 1:memposlength - 1 </span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">  94546 </span><span style="color: #000000; font-weight: bold">  90</span> <span style="color: #000000; background: #FFFFFF;">   ds(i + 1) = sqrt((mempos(i + 1,1) - mempos(i,1))^2 + (mempos(i + 1,2) - mempos(i,2))^2); </span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">  94546 </span><span style="color: #000000; font-weight: bold">  91</span> <span style="color: #000000; background: #FFFFFF;">   L = L + ds(i); </span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">  94546 </span><span style="color: #000000; font-weight: bold">  92</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF;">% to get the last part between the end and starting point of tracked</span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF;">% contour</span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  95</span> <span style="color: #000000; background: #FFFFFF;">ds(1) = sqrt((mempos(1,1) - mempos(i + 1,1))^2 + (mempos(1,2) - mempos(i + 1,2))^2);  </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold">  96</span> <span style="color: #000000; background: #FFFFFF;">L = L + ds(1); </span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  99</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 100</span> <span style="color: #228B22; background: #FFFFFF;">% calculate the center position of the contour</span><br/>               <span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 102</span> <span style="color: #000000; background: #FFFFFF;">for i = 1:memposlength - 1 </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  94546 </span><span style="color: #000000; font-weight: bold"> 103</span> <span style="color: #000000; background: #FFFFFF;">sumds(i) = ds(i) + ds(i + 1); </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  94546 </span><span style="color: #000000; font-weight: bold"> 104</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 105</span> <span style="color: #228B22; background: #FFFFFF;">% to get the last part between the end and starting point of tracked</span><br/>               <span style="color: #A0A0A0"> 106</span> <span style="color: #228B22; background: #FFFFFF;">% contour</span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 107</span> <span style="color: #000000; background: #FFFFFF;">sumds(i + 1) = ds(i + 1) + ds(1); </span><br/>               <span style="color: #A0A0A0"> 108</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 109</span> <span style="color: #000000; background: #FFFFFF;">center(1) = (1/(2*L)) * mempos(:,1)' * sumds; </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 110</span> <span style="color: #000000; background: #FFFFFF;">center(2) = (1/(2*L)) * mempos(:,2)' * sumds; </span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 113</span> <span style="color: #228B22; background: #FFFFFF;">% transformation of coordinate origin to center of vesicle</span><br/>               <span style="color: #A0A0A0"> 114</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 115</span> <span style="color: #000000; background: #FFFFFF;">mempos(:,1) = mempos(:,1) - center(1); </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 116</span> <span style="color: #000000; background: #FFFFFF;">mempos(:,2) = mempos(:,2) - center(2); </span><br/>               <span style="color: #A0A0A0"> 117</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 118</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 119</span> <span style="color: #228B22; background: #FFFFFF;">% TRANSFORMATION TO POLAR COORDINATES</span><br/>               <span style="color: #A0A0A0"> 120</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #228B22; background: #FFFFFF;">% with </span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #228B22; background: #FFFFFF;">% mempos(i,1) = r_i</span><br/>               <span style="color: #A0A0A0"> 123</span> <span style="color: #228B22; background: #FFFFFF;">% mempos(i,2) = theta_i</span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #228B22; background: #FFFFFF;">% matlab-version would be:</span><br/>               <span style="color: #A0A0A0"> 126</span> <span style="color: #228B22; background: #FFFFFF;">% [mempos(:,2),mempos(:,1)]=cart2pol(mempos(:,1),mempos(:,2));</span><br/>               <span style="color: #A0A0A0"> 127</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 128</span> <span style="color: #228B22; background: #FFFFFF;">% calculate radii (now the x_i and y_i are relative to center-position)</span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 129</span> <span style="color: #000000; background: #FFFFFF;">for i = 1:memposlength </span><br/><span style="color: #FF0000">  0.11 </span><span style="color: #0000FF">  94766 </span><span style="color: #000000; font-weight: bold"> 130</span> <span style="color: #000000; background: #FFFFFF;">mempospol(i,1) = sqrt(mempos(i,1)^2 + mempos(i,2)^2); </span><br/>               <span style="color: #A0A0A0"> 131</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 132</span> <span style="color: #228B22; background: #FFFFFF;">% calculate angles theta in range (-pi,pi]</span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  94766 </span><span style="color: #000000; font-weight: bold"> 133</span> <span style="color: #000000; background: #FFFFFF;">if mempos(i,1) &gt; 0 </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  46971 </span><span style="color: #000000; font-weight: bold"> 134</span> <span style="color: #000000; background: #FFFFFF;">mempospol(i,2) = atan(mempos(i,2) / mempos(i,1)); </span><br/>       <span style="color: #0000FF">  47795 </span><span style="color: #000000; font-weight: bold"> 135</span> <span style="color: #000000; background: #FFFFFF;">elseif mempos(i,1) &lt; 0 &amp;&amp; mempos(i,2) &gt;= 0 </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  23581 </span><span style="color: #000000; font-weight: bold"> 136</span> <span style="color: #000000; background: #FFFFFF;">    mempospol(i,2) = atan(mempos(i,2) / mempos(i,1)) + pi; </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  24214 </span><span style="color: #000000; font-weight: bold"> 137</span> <span style="color: #000000; background: #FFFFFF;">elseif mempos(i,1) &lt; 0 &amp;&amp; mempos(i,2) &lt; 0 </span><br/>       <span style="color: #0000FF">  24214 </span><span style="color: #000000; font-weight: bold"> 138</span> <span style="color: #000000; background: #FFFFFF;">    mempospol(i,2) = atan(mempos(i,2) / mempos(i,1)) - pi; </span><br/>               <span style="color: #A0A0A0"> 139</span> <span style="color: #A0A0A0; background: #FFFFFF;">elseif mempos(i,1) == 0 &amp;&amp; mempos(i,2) &gt; 0</span><br/>               <span style="color: #A0A0A0"> 140</span> <span style="color: #A0A0A0; background: #FFFFFF;">    mempospol(i,1) = pi / 2;</span><br/>               <span style="color: #A0A0A0"> 141</span> <span style="color: #A0A0A0; background: #FFFFFF;">elseif mempos(i,1) == 0 &amp;&amp; mempos(i,2) &lt; 0</span><br/>               <span style="color: #A0A0A0"> 142</span> <span style="color: #A0A0A0; background: #FFFFFF;">    mempospol(i,1) = - pi / 2;</span><br/>               <span style="color: #A0A0A0"> 143</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.11 </span><span style="color: #0000FF">  94766 </span><span style="color: #000000; font-weight: bold"> 145</span> <span style="color: #000000; background: #FFFFFF;">end % closes the angles calculation loop </span><br/>               <span style="color: #A0A0A0"> 146</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #228B22; background: #FFFFFF;">% change radius from pixels to meters</span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 148</span> <span style="color: #000000; background: #FFFFFF;">mempospol(:,1) = mempospol(:,1) * parameterStruct.resolution; </span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #228B22; background: #FFFFFF;">% set mempos to the polar coordinates for further processing</span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 151</span> <span style="color: #000000; background: #FFFFFF;">mempos = mempospol; </span><br/>               <span style="color: #A0A0A0"> 152</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 153</span> <span style="color: #228B22; background: #FFFFFF;">% save contours in polar coordinates</span><br/>               <span style="color: #A0A0A0"> 154</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 155</span> <span style="color: #228B22; background: #FFFFFF;">% save files in ascii text format</span><br/><a name="Line156"></a><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 156</span> <span style="color: #000000; background: #FFFFFF;">camino=sprintf('%s/contours/polarcontour%i.txt',working_directory_path,j); </span><br/><span style="color: #FF0000">  1.41 </span><span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 157</span> <span style="color: #000000; background: #FFF0F0;">save('camino','mempospol','-ascii'); % save the contour </span><br/>               <span style="color: #A0A0A0"> 158</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 160</span> <span style="color: #228B22; background: #FFFFFF;">% FOURIER TRANFORMATION</span><br/>               <span style="color: #A0A0A0"> 161</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 162</span> <span style="color: #228B22; background: #FFFFFF;">% a = zeros(parameterStruct.nmax,1); % coefficients of the fouriertransformation</span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #228B22; background: #FFFFFF;">% b = zeros(parameterStruct.nmax,1); </span><br/>               <span style="color: #A0A0A0"> 164</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line165"></a>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 165</span> <span style="color: #000000; background: #FFFFFF;">tmp = 0; </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 166</span> <span style="color: #000000; background: #FFFFFF;">tmp2 = 0; </span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 168</span> <span style="color: #228B22; background: #FFFFFF;">% calculate r0(j)</span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 169</span> <span style="color: #000000; background: #FFFFFF;">for i = 1:memposlength - 1 </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  94546 </span><span style="color: #000000; font-weight: bold"> 170</span> <span style="color: #000000; background: #FFFFFF;">    if mempos(i + 1,2) * mempos(i,2) &gt; 0 </span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">  94106 </span><span style="color: #000000; font-weight: bold"> 171</span> <span style="color: #000000; background: #FFFFFF;">    tmp = (mempos(i,1) + mempos(i + 1,1)) * abs(mempos(i + 1,2) - mempos(i,2)); </span><br/>       <span style="color: #0000FF">    440 </span><span style="color: #000000; font-weight: bold"> 172</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/>       <span style="color: #0000FF">    440 </span><span style="color: #000000; font-weight: bold"> 173</span> <span style="color: #000000; background: #FFFFFF;">        tmp = (mempos(i,1) + mempos(i + 1,1)) * abs(mempos(i + 1,2) + mempos(i,2)); </span><br/>       <span style="color: #0000FF">    440 </span><span style="color: #000000; font-weight: bold"> 174</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">  94546 </span><span style="color: #000000; font-weight: bold"> 175</span> <span style="color: #000000; background: #FFFFFF;">    tmp2 = tmp2 + tmp; </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  94546 </span><span style="color: #000000; font-weight: bold"> 176</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 177</span> <span style="color: #228B22; background: #FFFFFF;">% to get the last membrane part</span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 178</span> <span style="color: #000000; background: #FFFFFF;">if mempos(i + 1,2) * mempos(i,2) &gt; 0 </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 179</span> <span style="color: #000000; background: #FFFFFF;">tmp2 = tmp2 + (mempos(i + 1,1) + mempos(1,1)) * abs(mempos(1,2) - mempos(i + 1,2)); </span><br/>               <span style="color: #A0A0A0"> 180</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 181</span> <span style="color: #A0A0A0; background: #FFFFFF;">    tmp2 = tmp2 + (mempos(i + 1,1) + mempos(1,1)) * abs(mempos(1,2) + mempos(i + 1,2));</span><br/>               <span style="color: #A0A0A0"> 182</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 183</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 184</span> <span style="color: #000000; background: #FFFFFF;">r0(j) = (1/(4*pi)) * tmp2; </span><br/>               <span style="color: #A0A0A0"> 185</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 186</span> <span style="color: #228B22; background: #FFFFFF;">% substract the mean radius of the vesicle to get the fluctuations</span><br/>               <span style="color: #A0A0A0"> 187</span> <span style="color: #228B22; background: #FFFFFF;">% AS OF HERE mempos(:,1) will be the fluctuation of the membrane and NOT</span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #228B22; background: #FFFFFF;">% the radius of the membrane position</span><br/>               <span style="color: #A0A0A0"> 189</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 190</span> <span style="color: #000000; background: #FFFFFF;">for i=1:memposlength </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  94766 </span><span style="color: #000000; font-weight: bold"> 191</span> <span style="color: #000000; background: #FFFFFF;">   mempos(i,1) = mempos(i,1) - r0(j); </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  94766 </span><span style="color: #000000; font-weight: bold"> 192</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 193</span> <span style="color: #000000; background: #FFFFFF;">j; </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 194</span> <span style="color: #000000; background: #FFFFFF;">camino=sprintf('%s/memposs/mempos%i.txt',working_directory_path,j); </span><br/><span style="color: #FF0000">  1.49 </span><span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 195</span> <span style="color: #000000; background: #FFF0F0;">save('camino','mempos','-ascii') </span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 197</span> <span style="color: #000000; background: #FFFFFF;">for n = 1:parameterStruct.nmax % loop to calculate the fourier coefficients  </span><br/>               <span style="color: #A0A0A0"> 198</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 199</span> <span style="color: #228B22; background: #FFFFFF;">% calculate a_n</span><br/><a name="Line200"></a>       <span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 200</span> <span style="color: #000000; background: #FFFFFF;">tmp = 0; </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 201</span> <span style="color: #000000; background: #FFFFFF;">tmp2 = 0; </span><br/>               <span style="color: #A0A0A0"> 202</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 203</span> <span style="color: #000000; background: #FFFFFF;">for i = 1:memposlength - 1 </span><br/><span style="color: #FF0000">  3.11 </span><span style="color: #0000FF">4727300 </span><span style="color: #000000; font-weight: bold"> 204</span> <span style="color: #000000; background: #FFE2E2;">    if mempos(i + 1,2) * mempos(i,2) &gt; 0 </span><br/><span style="color: #FF0000">  4.15 </span><span style="color: #0000FF">4705300 </span><span style="color: #000000; font-weight: bold"> 205</span> <a name="Line205"></a><span style="color: #000000; background: #FFD4D4;">    tmp = (mempos(i,1) * cos(n*mempos(i,2)) + mempos(i + 1,1) * cos(n*mempos(i + 1,2))) * abs(mempos(i + 1,2) - mempos(i,2)) / 2; </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">  22000 </span><span style="color: #000000; font-weight: bold"> 206</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/>       <span style="color: #0000FF">  22000 </span><span style="color: #000000; font-weight: bold"> 207</span> <span style="color: #000000; background: #FFFFFF;">        tmp = (mempos(i,1) * cos(n*mempos(i,2)) + mempos(i + 1,1) * cos(n*mempos(i + 1,2))) * abs(mempos(i + 1,2) + mempos(i,2)) / 2; </span><br/>       <span style="color: #0000FF">  22000 </span><span style="color: #000000; font-weight: bold"> 208</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/><span style="color: #FF0000">  2.86 </span><span style="color: #0000FF">4727300 </span><span style="color: #000000; font-weight: bold"> 209</span> <span style="color: #000000; background: #FFE2E2;">    tmp2 = tmp2 + tmp; </span><br/><span style="color: #FF0000">  2.94 </span><span style="color: #0000FF">4727300 </span><span style="color: #000000; font-weight: bold"> 210</span> <span style="color: #000000; background: #FFE2E2;">end </span><br/>               <span style="color: #A0A0A0"> 211</span> <span style="color: #228B22; background: #FFFFFF;">% to get the last membrane part</span><br/>       <span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 212</span> <span style="color: #000000; background: #FFFFFF;">if mempos(1,2) * mempos(i + 1,2) &gt; 0 </span><br/>       <span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 213</span> <span style="color: #000000; background: #FFFFFF;">tmp2 = tmp2 + (mempos(i + 1,1) * cos(n*mempos(i + 1,2)) + mempos(1,1) * cos(n*mempos(1,2))) * abs(mempos(1,2) - mempos(i + 1,2)) / 2; </span><br/>               <span style="color: #A0A0A0"> 214</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 215</span> <span style="color: #A0A0A0; background: #FFFFFF;">    tmp2 = tmp2 + (mempos(i + 1,1) * cos(n*mempos(i + 1,2)) + mempos(1,1) * cos(n*mempos(1,2))) * abs(mempos(1,2) + mempos(i + 1,2)) / 2;</span><br/>               <span style="color: #A0A0A0"> 216</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 217</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 218</span> <span style="color: #000000; background: #FFFFFF;">a(n,j) = (1/(pi*r0(j))) * tmp2; </span><br/>               <span style="color: #A0A0A0"> 219</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 220</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 221</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 222</span> <span style="color: #228B22; background: #FFFFFF;">% calculate b_n</span><br/><a name="Line223"></a><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 223</span> <span style="color: #000000; background: #FFFFFF;">tmp = 0; </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 224</span> <span style="color: #000000; background: #FFFFFF;">tmp2 = 0; </span><br/>               <span style="color: #A0A0A0"> 225</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 226</span> <span style="color: #000000; background: #FFFFFF;">for i = 1:memposlength - 1 </span><br/><span style="color: #FF0000">  3.60 </span><span style="color: #0000FF">4727300 </span><span style="color: #000000; font-weight: bold"> 227</span> <span style="color: #000000; background: #FFE2E2;">    if mempos(i + 1,2) * mempos(i,2) &gt; 0 </span><br/><span style="color: #FF0000">  4.60 </span><span style="color: #0000FF">4705300 </span><span style="color: #000000; font-weight: bold"> 228</span> <a name="Line228"></a><span style="color: #000000; background: #FFD4D4;">    tmp = (mempos(i,1) * sin(n*mempos(i,2)) + mempos(i + 1,1) * sin(n*mempos(i + 1,2))) * abs(mempos(i + 1,2) - mempos(i,2)) / 2; </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  22000 </span><span style="color: #000000; font-weight: bold"> 229</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/>       <span style="color: #0000FF">  22000 </span><span style="color: #000000; font-weight: bold"> 230</span> <span style="color: #000000; background: #FFFFFF;">        tmp = (mempos(i,1) * sin(n*mempos(i,2)) + mempos(i + 1,1) * sin(n*mempos(i + 1,2))) * abs(mempos(i + 1,2) + mempos(i,2)) / 2; </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  22000 </span><span style="color: #000000; font-weight: bold"> 231</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/><span style="color: #FF0000">  3.12 </span><span style="color: #0000FF">4727300 </span><span style="color: #000000; font-weight: bold"> 232</span> <span style="color: #000000; background: #FFE2E2;">    tmp2 = tmp2 + tmp; </span><br/><span style="color: #FF0000">  3.21 </span><span style="color: #0000FF">4727300 </span><span style="color: #000000; font-weight: bold"> 233</span> <span style="color: #000000; background: #FFE2E2;">end </span><br/>               <span style="color: #A0A0A0"> 234</span> <span style="color: #228B22; background: #FFFFFF;">% to get the last membrane part</span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 235</span> <span style="color: #000000; background: #FFFFFF;">if mempos(1,2) * mempos(i + 1,2) &gt; 0 </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 236</span> <span style="color: #000000; background: #FFFFFF;">tmp2 = tmp2 + (mempos(i + 1,1) * sin(n*mempos(i + 1,2)) + mempos(1,1) * sin(n*mempos(1,2))) * abs(mempos(1,2) - mempos(i + 1,2)) / 2; </span><br/>               <span style="color: #A0A0A0"> 237</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 238</span> <span style="color: #A0A0A0; background: #FFFFFF;">    tmp2 = tmp2 + (mempos(i + 1,1) * sin(n*mempos(i + 1,2)) + mempos(1,1) * sin(n*mempos(1,2))) * abs(mempos(1,2) + mempos(i + 1,2)) / 2;  </span><br/>               <span style="color: #A0A0A0"> 239</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 240</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 241</span> <span style="color: #000000; background: #FFFFFF;">b(n,j) = (1/(pi*r0(j))) * tmp2; </span><br/>               <span style="color: #A0A0A0"> 242</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 243</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 244</span> <span style="color: #000000; background: #FFFFFF;">c(n,j) = sqrt(a(n,j)^2 + b(n,j)^2); </span><br/>               <span style="color: #A0A0A0"> 245</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">  11000 </span><span style="color: #000000; font-weight: bold"> 246</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 247</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 248</span> <span style="color: #228B22; background: #FFFFFF;">% this checks if one of the coefficients of c is larger than 1.5; if so the</span><br/>               <span style="color: #A0A0A0"> 249</span> <span style="color: #228B22; background: #FFFFFF;">% contour will be deleted</span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 250</span> <span style="color: #000000; background: #FFFFFF;">if any(c(:,j)&gt;parameterStruct.maxc) == 1 </span><br/>               <span style="color: #A0A0A0"> 251</span> <span style="color: #A0A0A0; background: #FFFFFF;">    deletedcontourscounter = deletedcontourscounter + 1;</span><br/>               <span style="color: #A0A0A0"> 252</span> <span style="color: #A0A0A0; background: #FFFFFF;">    deletedcontours(deletedcontourscounter) = j;</span><br/>               <span style="color: #A0A0A0"> 253</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 254</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 255</span> <span style="color: #000000; background: #FFFFFF;">clear mempos L mempospol </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 256</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 257</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 258</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 259</span> <span style="color: #228B22; background: #FFFFFF;">% this creates a new index of the NOT deleted contours and saves it</span><br/>               <span style="color: #A0A0A0"> 260</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 261</span> <span style="color: #228B22; background: #FFFFFF;">% variables:</span><br/>               <span style="color: #A0A0A0"> 262</span> <span style="color: #228B22; background: #FFFFFF;">% savecontours: will contain the saved contours</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 263</span> <span style="color: #000000; background: #FFFFFF;">savedcontourscounter = 0; %counter </span><br/>               <span style="color: #A0A0A0"> 264</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 265</span> <span style="color: #000000; background: #FFFFFF;">clear savedcontours; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 266</span> <span style="color: #000000; background: #FFFFFF;">for j = 1:contournr </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 267</span> <span style="color: #000000; background: #FFFFFF;">    if any(j == deletedcontours) == 0 </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 268</span> <span style="color: #000000; background: #FFFFFF;">        savedcontourscounter = savedcontourscounter + 1; </span><br/><a name="Line269"></a>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 269</span> <span style="color: #000000; background: #FFFFFF;">        savedcontours(savedcontourscounter) = j; </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 270</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 271</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 272</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 273</span> <span style="color: #228B22; background: #FFFFFF;">% save c.mat 'c'</span><br/>               <span style="color: #A0A0A0"> 274</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 275</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 276</span> <span style="color: #228B22; background: #FFFFFF;">% calculate fluctuation of the modulus of c(n)</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 277</span> <span style="color: #000000; background: #FFFFFF;">fluctuation = zeros(1,parameterStruct.nmax); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 278</span> <span style="color: #000000; background: #FFFFFF;">cmean = zeros(1,parameterStruct.nmax); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 279</span> <span style="color: #000000; background: #FFFFFF;">cmeansquare = zeros(1,parameterStruct.nmax); </span><br/>               <span style="color: #A0A0A0"> 280</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 281</span> <span style="color: #000000; background: #FFFFFF;">for j = savedcontours </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 282</span> <span style="color: #000000; background: #FFFFFF;">    cmean = cmean + transpose(c(:,j)); </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 283</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 284</span> <span style="color: #000000; background: #FFFFFF;">cmean = cmean/length(savedcontours); </span><br/>               <span style="color: #A0A0A0"> 285</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 286</span> <span style="color: #000000; background: #FFFFFF;">for j = savedcontours </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 287</span> <span style="color: #000000; background: #FFFFFF;">    cmeansquare = cmeansquare + transpose(c(:,j).^2); </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 288</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 289</span> <span style="color: #000000; background: #FFFFFF;">cmeansquare = cmeansquare/length(savedcontours); </span><br/>               <span style="color: #A0A0A0"> 290</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 291</span> <span style="color: #000000; background: #FFFFFF;">for n = 1:parameterStruct.nmax </span><br/>       <span style="color: #0000FF">     50 </span><span style="color: #000000; font-weight: bold"> 292</span> <span style="color: #000000; background: #FFFFFF;">fluctuation(n) = cmeansquare(n) - cmean(n)^2; </span><br/>               <span style="color: #A0A0A0"> 293</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     50 </span><span style="color: #000000; font-weight: bold"> 294</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 295</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 296</span> <span style="color: #000000; background: #FFFFFF;">tmp = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 297</span> <span style="color: #000000; background: #FFFFFF;">for j = savedcontours </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 298</span> <span style="color: #000000; background: #FFFFFF;">    tmp = tmp + r0(j); </span><br/>       <span style="color: #0000FF">    220 </span><span style="color: #000000; font-weight: bold"> 299</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 300</span> <span style="color: #000000; background: #FFFFFF;">rmean = tmp/length(savedcontours); </span><br/>               <span style="color: #A0A0A0"> 301</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 302</span> <span style="color: #228B22; background: #FFFFFF;">%fluctuation = ((pi*(rmean*parameterStruct.resolution)^3)/2)*fluctuation;</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 303</span> <span style="color: #000000; background: #FFFFFF;">fluctuation = ((pi*rmean^3)/2)*fluctuation; </span><br/>               <span style="color: #A0A0A0"> 304</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 305</span> <span style="color: #228B22; background: #FFFFFF;">% wave numbers</span><br/>               <span style="color: #A0A0A0"> 306</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 307</span> <span style="color: #000000; background: #FFFFFF;">for j = 1:parameterStruct.nmax </span><br/>       <span style="color: #0000FF">     50 </span><span style="color: #000000; font-weight: bold"> 308</span> <span style="color: #000000; background: #FFFFFF;">   wavenumbers(j) = j/(rmean);  </span><br/>       <span style="color: #0000FF">     50 </span><span style="color: #000000; font-weight: bold"> 309</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 310</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 311</span> <span style="color: #000000; background: #FFFFFF;">fluctuation = transpose(fluctuation); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 312</span> <span style="color: #000000; background: #FFFFFF;">wavenumbers = transpose(wavenumbers); </span><br/>               <span style="color: #A0A0A0"> 313</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 314</span> <span style="color: #228B22; background: #FFFFFF;">% save fluctuations</span><br/>               <span style="color: #A0A0A0"> 315</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  3.72 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 316</span> <a name="Line316"></a><span style="color: #000000; background: #FFE2E2;">save(sprintf('%s/results/fluctuations.txt',working_directory_path),'fluctuation','-ascii') </span><br/>               <span style="color: #A0A0A0"> 317</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.11 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 318</span> <span style="color: #000000; background: #FFFFFF;">save(sprintf('%s/results/wavenumbers.txt',working_directory_path),'wavenumbers','-ascii') </span><br/>               <span style="color: #A0A0A0"> 319</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.22 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 320</span> <span style="color: #000000; background: #FFFFFF;">save(sprintf('%s/results/a.txt',working_directory_path),'a','-ascii') </span><br/>               <span style="color: #A0A0A0"> 321</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.19 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 322</span> <span style="color: #000000; background: #FFFFFF;">save(sprintf('%s/results/b.txt',working_directory_path),'b','-ascii') </span><br/>               <span style="color: #A0A0A0"> 323</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.22 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 324</span> <span style="color: #000000; background: #FFFFFF;">save(sprintf('%s/results/c.txt',working_directory_path),'c','-ascii') </span><br/>               <span style="color: #A0A0A0"> 325</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 326</span> <span style="color: #000000; background: #FFFFFF;">save(sprintf('%s/results/r0.txt',working_directory_path),'r0','-ascii') </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 327</span> <span style="color: #000000; background: #FFFFFF;">diametro=rmean*2*100; </span><br/>               <span style="color: #A0A0A0"> 328</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 329</span> <span style="color: #228B22; background: #FFFFFF;">% for n=1:parameterStruct.nmax % calculates the fluctuation of c(n) of the ensemble for each n</span><br/>               <span style="color: #A0A0A0"> 330</span> <span style="color: #228B22; background: #FFFFFF;">% fluctuation(n)=mean(c(n,:).^2)-mean(c(n,:)).^2;</span><br/>               <span style="color: #A0A0A0"> 331</span> <span style="color: #228B22; background: #FFFFFF;">% end</span><br/>               <span style="color: #A0A0A0"> 332</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 333</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 334</span> <span style="color: #228B22; background: #FFFFFF;">% for j=savedcontours</span><br/>               <span style="color: #A0A0A0"> 335</span> <span style="color: #228B22; background: #FFFFFF;">%     j</span><br/>               <span style="color: #A0A0A0"> 336</span> <span style="color: #228B22; background: #FFFFFF;">% contornos = load(sprintf('%s/contours/polarcontour%i.txt',working_directory_path,j)); % load the membrane position in polar coordinates</span><br/>               <span style="color: #A0A0A0"> 337</span> <span style="color: #228B22; background: #FFFFFF;">% end</span><br/>               <span style="color: #A0A0A0"> 338</span> <span style="color: #228B22; background: #FFFFFF;">% % n1=lenght(contornos)</span><br/>               <span style="color: #A0A0A0"> 339</span> <span style="color: #228B22; background: #FFFFFF;">% % n=1:n1;</span><br/>               <span style="color: #A0A0A0"> 340</span> <span style="color: #228B22; background: #FFFFFF;">% % teta=contornos(2,n)</span><br/>               <span style="color: #A0A0A0"> 341</span> <span style="color: #228B22; background: #FFFFFF;">% % radiopolar=(1,n)</span><br/>               <span style="color: #A0A0A0"> 342</span> <span style="color: #228B22; background: #FFFFFF;">% % sigmacero=0.1*parameterStruct.resolution;</span><br/>               <span style="color: #A0A0A0"> 343</span> <span style="color: #228B22; background: #FFFFFF;">% % temp=0</span><br/>               <span style="color: #A0A0A0"> 344</span> <span style="color: #228B22; background: #FFFFFF;">% % for i=2:(n1-1)</span><br/>               <span style="color: #A0A0A0"> 345</span> <span style="color: #228B22; background: #FFFFFF;">% %     factor1=((teta(i+1)-teta(i-1))./(4*pi)).*(2*(sigmacero^2))</span><br/>               <span style="color: #A0A0A0"> 346</span> <span style="color: #228B22; background: #FFFFFF;">% %     factor2=((radiopolar(i+1)-radiopolar(i-1))./(4*pi)).*((2*(sigmacero^2))./(radiopolar(i)^2))</span><br/>               <span style="color: #A0A0A0"> 347</span> <span style="color: #228B22; background: #FFFFFF;">% %     factor3=((teta(i+1)-teta(i-1))./(4*pi)).*((radiopolar(i+1)-radiopolar(i-1))./(4*pi)).*((2*(sigmacero^2))./(radiopolar(i)^2))</span><br/>               <span style="color: #A0A0A0"> 348</span> <span style="color: #228B22; background: #FFFFFF;">% %     factor4=factor1+factor2+factor3+temp</span><br/>               <span style="color: #A0A0A0"> 349</span> <span style="color: #228B22; background: #FFFFFF;">% %     temp=factor4</span><br/>               <span style="color: #A0A0A0"> 350</span> <span style="color: #228B22; background: #FFFFFF;">% % end </span><br/>               <span style="color: #A0A0A0"> 351</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 352</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 353</span> <span style="color: #228B22; background: #FFFFFF;">% contornos =load('C:/membrane_tracking_project/medidas/ruddi/popcambiente19/contours/polarcontour165.txt')%load(sprintf('%s/contours/polarcontour%i.txt',working_directory_path,j)); % load the membrane position in polar coordinates</span><br/>               <span style="color: #A0A0A0"> 354</span> <span style="color: #228B22; background: #FFFFFF;">% </span><br/>               <span style="color: #A0A0A0"> 355</span> <span style="color: #228B22; background: #FFFFFF;">% n1=length(contornos)</span><br/>               <span style="color: #A0A0A0"> 356</span> <span style="color: #228B22; background: #FFFFFF;">% n=1:n1;</span><br/>               <span style="color: #A0A0A0"> 357</span> <span style="color: #228B22; background: #FFFFFF;">% teta=contornos(n,2)</span><br/>               <span style="color: #A0A0A0"> 358</span> <span style="color: #228B22; background: #FFFFFF;">% radiopolar=contornos(n,1)</span><br/>               <span style="color: #A0A0A0"> 359</span> <span style="color: #228B22; background: #FFFFFF;">% sigmacero=0.1*parameterStruct.resolution;</span><br/>               <span style="color: #A0A0A0"> 360</span> <span style="color: #228B22; background: #FFFFFF;">% temp=0</span><br/>               <span style="color: #A0A0A0"> 361</span> <span style="color: #228B22; background: #FFFFFF;">% for i=2:(n1-1)</span><br/>               <span style="color: #A0A0A0"> 362</span> <span style="color: #228B22; background: #FFFFFF;">%     factor1=((teta(i+1)-teta(i-1))./(4*pi)).*(2*(sigmacero^2))</span><br/>               <span style="color: #A0A0A0"> 363</span> <span style="color: #228B22; background: #FFFFFF;">%     factor2=((radiopolar(i+1)-radiopolar(i-1))./(4*pi)).*((2*(sigmacero^2))./(radiopolar(i)^2))</span><br/>               <span style="color: #A0A0A0"> 364</span> <span style="color: #228B22; background: #FFFFFF;">%     factor3=((teta(i+1)-teta(i-1))./(4*pi)).*((radiopolar(i+1)-radiopolar(i-1))./(4*pi)).*((2*(sigmacero^2))./(radiopolar(i)^2))</span><br/>               <span style="color: #A0A0A0"> 365</span> <span style="color: #228B22; background: #FFFFFF;">%     factor4=factor1+factor2+factor3+temp</span><br/>               <span style="color: #A0A0A0"> 366</span> <span style="color: #228B22; background: #FFFFFF;">%     temp=factor4</span><br/>               <span style="color: #A0A0A0"> 367</span> <span style="color: #228B22; background: #FFFFFF;">% end </span><br/>               <span style="color: #A0A0A0"> 368</span> <span style="color: #228B22; background: #FFFFFF;">% </span><br/>               <span style="color: #A0A0A0"> 369</span> <span style="color: #228B22; background: #FFFFFF;">% m=32</span><br/>               <span style="color: #A0A0A0"> 370</span> <span style="color: #228B22; background: #FFFFFF;">% </span><br/>               <span style="color: #A0A0A0"> 371</span> <span style="color: #228B22; background: #FFFFFF;">% c=(c(m,savedcontours))</span><br/>               <span style="color: #A0A0A0"> 372</span> <span style="color: #228B22; background: #FFFFFF;">% a=(a(m,savedcontours))</span><br/>               <span style="color: #A0A0A0"> 373</span> <span style="color: #228B22; background: #FFFFFF;">% b=(b(m,savedcontours))</span><br/>               <span style="color: #A0A0A0"> 374</span> <span style="color: #228B22; background: #FFFFFF;">% desviaciona=std(a)</span><br/>               <span style="color: #A0A0A0"> 375</span> <span style="color: #228B22; background: #FFFFFF;">% desviacionb=std(b)</span><br/>               <span style="color: #A0A0A0"> 376</span> <span style="color: #228B22; background: #FFFFFF;">% desviacionc=std(c)</span><br/>               <span style="color: #A0A0A0"> 377</span> <span style="color: #228B22; background: #FFFFFF;">% sumadesviacionc=(sum(desviacionc))</span><br/>               <span style="color: #A0A0A0"> 378</span> <span style="color: #228B22; background: #FFFFFF;">% </span><br/>               <span style="color: #A0A0A0"> 379</span> <span style="color: #228B22; background: #FFFFFF;">% lon=length(savedcontours)^2</span><br/>               <span style="color: #A0A0A0"> 380</span> <span style="color: #228B22; background: #FFFFFF;">% desviacioncmedia=sumadesviacionc*(1/lon)</span><br/>               <span style="color: #A0A0A0"> 381</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 382</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 383</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 384</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 385</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 386</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 387</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 388</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 389</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 390</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 391</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 392</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 393</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 394</span> <span style="color: #228B22; background: #FFFFFF;">% c=(c(1,savedcontours))</span><br/>               <span style="color: #A0A0A0"> 395</span> <span style="color: #228B22; background: #FFFFFF;">% c=c.^2</span><br/>               <span style="color: #A0A0A0"> 396</span> <span style="color: #228B22; background: #FFFFFF;">% fid=fopen('results.txt','w+')</span><br/>               <span style="color: #A0A0A0"> 397</span> <span style="color: #228B22; background: #FFFFFF;">% </span><br/>               <span style="color: #A0A0A0"> 398</span> <span style="color: #228B22; background: #FFFFFF;">% j=length(c)</span><br/>               <span style="color: #A0A0A0"> 399</span> <span style="color: #228B22; background: #FFFFFF;">% for tao=1:j</span><br/>               <span style="color: #A0A0A0"> 400</span> <span style="color: #228B22; background: #FFFFFF;">%     j=length(c)</span><br/>               <span style="color: #A0A0A0"> 401</span> <span style="color: #228B22; background: #FFFFFF;">%     temp=0</span><br/>               <span style="color: #A0A0A0"> 402</span> <span style="color: #228B22; background: #FFFFFF;">% for i=1:(j-tao)</span><br/>               <span style="color: #A0A0A0"> 403</span> <span style="color: #228B22; background: #FFFFFF;">% P=c(i)*c(i+tao)</span><br/>               <span style="color: #A0A0A0"> 404</span> <span style="color: #228B22; background: #FFFFFF;">% suma=temp+P</span><br/>               <span style="color: #A0A0A0"> 405</span> <span style="color: #228B22; background: #FFFFFF;">% temp=suma; </span><br/>               <span style="color: #A0A0A0"> 406</span> <span style="color: #228B22; background: #FFFFFF;">% i</span><br/>               <span style="color: #A0A0A0"> 407</span> <span style="color: #228B22; background: #FFFFFF;">% end</span><br/>               <span style="color: #A0A0A0"> 408</span> <span style="color: #228B22; background: #FFFFFF;">% suma=suma./j</span><br/>               <span style="color: #A0A0A0"> 409</span> <span style="color: #228B22; background: #FFFFFF;">% tiempo=tao*0.0666;</span><br/>               <span style="color: #A0A0A0"> 410</span> <span style="color: #228B22; background: #FFFFFF;">% fid=fopen('results.txt','a+')</span><br/>               <span style="color: #A0A0A0"> 411</span> <span style="color: #228B22; background: #FFFFFF;">% fprintf(fid,'%6.9e       %6.3e\n',suma,tiempo)</span><br/>               <span style="color: #A0A0A0"> 412</span> <span style="color: #228B22; background: #FFFFFF;">% fclose(fid)</span><br/>               <span style="color: #A0A0A0"> 413</span> <span style="color: #228B22; background: #FFFFFF;">% end</span><br/>               <span style="color: #A0A0A0"> 414</span> <span style="color: #228B22; background: #FFFFFF;">% Autofunctiondatos=load('D:/membrane_tracking_project/program/results.txt')</span><br/>               <span style="color: #A0A0A0"> 415</span> <span style="color: #228B22; background: #FFFFFF;">% h=1:j;</span><br/>               <span style="color: #A0A0A0"> 416</span> <span style="color: #228B22; background: #FFFFFF;">% Function=(Autofunctiondatos(h,1))/(Autofunctiondatos(1,1))</span><br/>               <span style="color: #A0A0A0"> 417</span> <span style="color: #228B22; background: #FFFFFF;">% tiempo=Autofunctiondatos(h,2)</span><br/>               <span style="color: #A0A0A0"> 418</span> <span style="color: #228B22; background: #FFFFFF;">% figure(4)</span><br/>               <span style="color: #A0A0A0"> 419</span> <span style="color: #228B22; background: #FFFFFF;">% plot(tiempo,Function,'o')</span><br/>               <span style="color: #A0A0A0"> 420</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 421</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 422</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 423</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 424</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 425</span> <span style="color: #228B22; background: #FFFFFF;">%  V=diff(c)</span><br/>               <span style="color: #A0A0A0"> 426</span> <span style="color: #228B22; background: #FFFFFF;">%  tiempo1=0:0.066:((0.066*(j-1)))</span><br/>               <span style="color: #A0A0A0"> 427</span> <span style="color: #228B22; background: #FFFFFF;">% %  figure(3)</span><br/>               <span style="color: #A0A0A0"> 428</span> <span style="color: #228B22; background: #FFFFFF;">% %  plot(tiempo1,V)</span><br/>               <span style="color: #A0A0A0"> 429</span> <span style="color: #228B22; background: #FFFFFF;">%  fid=fopen('resultsvelocidad.txt','a+')</span><br/>               <span style="color: #A0A0A0"> 430</span> <span style="color: #228B22; background: #FFFFFF;">%  fprintf(fid,'%6.4e\n',V)</span><br/>               <span style="color: #A0A0A0"> 431</span> <span style="color: #228B22; background: #FFFFFF;">%  fclose(fid)</span><br/>               <span style="color: #A0A0A0"> 432</span> <span style="color: #228B22; background: #FFFFFF;">%  fid=fopen('resultstiempo.txt','a+')</span><br/>               <span style="color: #A0A0A0"> 433</span> <span style="color: #228B22; background: #FFFFFF;">%  fprintf(fid,'%6.4e\n',tiempo1)</span><br/>               <span style="color: #A0A0A0"> 434</span> <span style="color: #228B22; background: #FFFFFF;">%  fclose(fid)</span><br/>               <span style="color: #A0A0A0"> 435</span> <span style="color: #228B22; background: #FFFFFF;">% </span><br/>               <span style="color: #A0A0A0"> 436</span> <span style="color: #228B22; background: #FFFFFF;">% j=0</span><br/>               <span style="color: #A0A0A0"> 437</span> <span style="color: #228B22; background: #FFFFFF;">% h=0</span><br/>               <span style="color: #A0A0A0"> 438</span> <span style="color: #228B22; background: #FFFFFF;">%   velocidad=load('D:/membrane_tracking_project/program/resultsvelocidad.txt')</span><br/>               <span style="color: #A0A0A0"> 439</span> <span style="color: #228B22; background: #FFFFFF;">%   tiemporeal=load('D:/membrane_tracking_project/program/resultstiempo.txt')</span><br/>               <span style="color: #A0A0A0"> 440</span> <span style="color: #228B22; background: #FFFFFF;">% </span><br/>               <span style="color: #A0A0A0"> 441</span> <span style="color: #228B22; background: #FFFFFF;">%   j=length(velocidad)</span><br/>               <span style="color: #A0A0A0"> 442</span> <span style="color: #228B22; background: #FFFFFF;">%   for taov=1:j</span><br/>               <span style="color: #A0A0A0"> 443</span> <span style="color: #228B22; background: #FFFFFF;">%    j=length(velocidad)</span><br/>               <span style="color: #A0A0A0"> 444</span> <span style="color: #228B22; background: #FFFFFF;">%     tempv=0</span><br/>               <span style="color: #A0A0A0"> 445</span> <span style="color: #228B22; background: #FFFFFF;">%   for i=1:(j-taov)</span><br/>               <span style="color: #A0A0A0"> 446</span> <span style="color: #228B22; background: #FFFFFF;">%   Pv=velocidad(i)*velocidad(i+taov)</span><br/>               <span style="color: #A0A0A0"> 447</span> <span style="color: #228B22; background: #FFFFFF;">%   sumav=tempv+Pv</span><br/>               <span style="color: #A0A0A0"> 448</span> <span style="color: #228B22; background: #FFFFFF;">%   tempv=sumav; </span><br/>               <span style="color: #A0A0A0"> 449</span> <span style="color: #228B22; background: #FFFFFF;">%   i</span><br/>               <span style="color: #A0A0A0"> 450</span> <span style="color: #228B22; background: #FFFFFF;">%   end</span><br/>               <span style="color: #A0A0A0"> 451</span> <span style="color: #228B22; background: #FFFFFF;">%    sumav=sumav./j</span><br/>               <span style="color: #A0A0A0"> 452</span> <span style="color: #228B22; background: #FFFFFF;">%    tiempov=taov*0.0666;</span><br/>               <span style="color: #A0A0A0"> 453</span> <span style="color: #228B22; background: #FFFFFF;">%    fid=fopen('resultscorrelation.txt','a+')</span><br/>               <span style="color: #A0A0A0"> 454</span> <span style="color: #228B22; background: #FFFFFF;">%    fprintf(fid,'%6.9e       %6.3e\n',sumav,tiempov)</span><br/>               <span style="color: #A0A0A0"> 455</span> <span style="color: #228B22; background: #FFFFFF;">%    fclose(fid)</span><br/>               <span style="color: #A0A0A0"> 456</span> <span style="color: #228B22; background: #FFFFFF;">%    end</span><br/>               <span style="color: #A0A0A0"> 457</span> <span style="color: #228B22; background: #FFFFFF;">%  Autofunctivelocidaddatos=load('D:/membrane_tracking_project/program/resultscorrelation.txt')</span><br/>               <span style="color: #A0A0A0"> 458</span> <span style="color: #228B22; background: #FFFFFF;">%  h=1:j;</span><br/>               <span style="color: #A0A0A0"> 459</span> <span style="color: #228B22; background: #FFFFFF;">%  Functionv=Autofunctivelocidaddatos(h,1)</span><br/>               <span style="color: #A0A0A0"> 460</span> <span style="color: #228B22; background: #FFFFFF;">%  tiempov=Autofunctivelocidaddatos(h,2)</span><br/>               <span style="color: #A0A0A0"> 461</span> <span style="color: #228B22; background: #FFFFFF;">%  figure(5)</span><br/>               <span style="color: #A0A0A0"> 462</span> <span style="color: #228B22; background: #FFFFFF;">%  plot(tiempov,Functionv,'o')</span><br/></pre></body></html>