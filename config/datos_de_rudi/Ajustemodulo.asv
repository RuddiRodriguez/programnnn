
% clc
% clear
fluct=load('C:/MATLAB7/work/Modulodatos/fluctuations.txt');
wave=load('C:/MATLAB7/work/Modulodatos/wavenumbers.txt');
a=size(wave)
n=6:26
fluct=(fluct(n))
qx=(wave(n))
eta=0.001
figure(1)
semilogy(qx,fluct,'-o')
figure(2)
plot(qx,fluct,'-o')



%cuadratura de gauuss laguerre
%ftype=fittype('72174624735200143612372962992139519381985347825/13803492693581127574869511724554050904902217944340773110325048447598592*qx^3/(4816437861622157/4503599627370496*a*qx^2+5151007104157705/4503599627370496*b*qx^4)^3*(56294995342131200/3493044605262831/qx*(4816437861622157/4503599627370496*a*qx^2+5151007104157705/4503599627370496*b*qx^4)+exp(-56294995342131200/3493044605262831/qx*(4816437861622157/4503599627370496*a*qx^2+5151007104157705/4503599627370496*b*qx^4))-1)+77289529412866234758850537653996116806628655425/6901746346790563787434755862277025452451108972170386555162524223799296*qx^3/(3375119391557767/1125899906842624*a*qx^2+5058811550670793/562949953421312*b*qx^4)^3*(45035996273704960/4678489977030699/qx*(3375119391557767/1125899906842624*a*qx^2+5058811550670793/562949953421312*b*qx^4)+exp(-45035996273704960/4678489977030699/qx*(3375119391557767/1125899906842624*a*qx^2+5058811550670793/562949953421312*b*qx^4))-1)+34218448259392639438523207413873682525270543225/3450873173395281893717377931138512726225554486085193277581262111899648*qx^3/(7844301334923487/562949953421312*a*qx^2+1707885594978209/8796093022208*b*qx^4)^3*(11258999068426240/2521699161757761/qx*(7844301334923487/562949953421312*a*qx^2+1707885594978209/8796093022208*b*qx^4)+exp(-11258999068426240/2521699161757761/qx*(7844301334923487/562949953421312*a*qx^2+1707885594978209/8796093022208*b*qx^4))-1)+47845788957796788702214894287125362921001314275/27606985387162255149739023449108101809804435888681546220650096895197184*qx^3/(7206984303956217/140737488355328*a*qx^2+720820941233925/274877906944*b*qx^4)^3*(11258999068426240/4834181183463111/qx*(7206984303956217/140737488355328*a*qx^2+720820941233925/274877906944*b*qx^4)+exp(-11258999068426240/4834181183463111/qx*(7206984303956217/140737488355328*a*qx^2+720820941233925/274877906944*b*qx^4))-1)+486035552210393471836571372685798000238384375/13803492693581127574869511724554050904902217944340773110325048447598592*qx^3/(5657289769229875/35184372088832*a*qx^2+1776630372431643/68719476736*b*qx^4)^3*(219902325555200/167305563187089/qx*(5657289769229875/35184372088832*a*qx^2+1776630372431643/68719476736*b*qx^4)+exp(-219902325555200/167305563187089/qx*(5657289769229875/35184372088832*a*qx^2+1776630372431643/68719476736*b*qx^4))-1) ','ind','qx','Levenberg-Marquardt')
ftype = fittype('86131723981357271686750207030917009197377559875/13803492693581127574869511724554050904902217944340773110325048447598592*qx^3/(4972140676145015/4503599627370496*a*qx^2+5489427335664445/4503599627370496*b*qx^4)^3*(112589990684262400/7098112038896037/qx*(4972140676145015/4503599627370496*a*qx^2+5489427335664445/4503599627370496*b*qx^4)+exp(-112589990684262400/7098112038896037/qx*(4972140676145015/4503599627370496*a*qx^2+5489427335664445/4503599627370496*b*qx^4))-1)+46781576841508965099649462798448872477313283375/3450873173395281893717377931138512726225554486085193277581262111899648*qx^3/(2278642293337305/562949953421312*a*qx^2+2305804747575687/140737488355328*b*qx^4)^3*(22517998136852480/2718217551980133/qx*(2278642293337305/562949953421312*a*qx^2+2305804747575687/140737488355328*b*qx^4)+exp(-22517998136852480/2718217551980133/qx*(2278642293337305/562949953421312*a*qx^2+2305804747575687/140737488355328*b*qx^4))-1)+54275750806007000319552341842596195131041023225/6901746346790563787434755862277025452451108972170386555162524223799296*qx^3/(6074490001041099/281474976710656*a*qx^2+8193319083804227/17592186044416*b*qx^4)^3*(28147497671065600/7845598099354671/qx*(6074490001041099/281474976710656*a*qx^2+8193319083804227/17592186044416*b*qx^4)+exp(-28147497671065600/7845598099354671/qx*(6074490001041099/281474976710656*a*qx^2+8193319083804227/17592186044416*b*qx^4))-1)+99629978708602951608745794609064503995670102725/220855883097298041197912187592864814478435487109452369765200775161577472*qx^3/(6281631839615597/70368744177664*a*qx^2+273801110731667/34359738368*b*qx^4)^3*(7036874417766400/3989122658160117/qx*(6281631839615597/70368744177664*a*qx^2+273801110731667/34359738368*b*qx^4)+exp(-7036874417766400/3989122658160117/qx*(6281631839615597/70368744177664*a*qx^2+273801110731667/34359738368*b*qx^4))-1)','ind','qx','Levenberg-Marquardt')




%cuadratura de gauus sencilla
%ftype=fittype('4508621084901342414678460521811/174224571863520493293247799005065324265472*(1/250*qx^2+4517926104973675/33554432)^3/(a*(qx^2+8824074423776709/262144)^2+b*(qx^2+8824074423776709/262144)^2)^3*(1/15/(1/250*qx^2+4517926104973675/33554432)*(a*(qx^2+8824074423776709/262144)^2+b*(qx^2+8824074423776709/262144)^2)+exp(-1/15/(1/250*qx^2+4517926104973675/33554432)*(a*(qx^2+8824074423776709/262144)^2+b*(qx^2+8824074423776709/262144)^2))-1)+8452594585836396898857010012845/174224571863520493293247799005065324265472*(1/250*qx^2+6742682270804341/8388608)^3/(a*(qx^2+1646162663770591/8192)^2+b*(qx^2+1646162663770591/8192)^2)^3*(1/15/(1/250*qx^2+6742682270804341/8388608)*(a*(qx^2+1646162663770591/8192)^2+b*(qx^2+1646162663770591/8192)^2)+exp(-1/15/(1/250*qx^2+6742682270804341/8388608)*(a*(qx^2+1646162663770591/8192)^2+b*(qx^2+1646162663770591/8192)^2))-1)+8452594585836396898857010012845/174224571863520493293247799005065324265472*(1/250*qx^2+5285342454898473/2097152)^3/(a*(qx^2+2580733620555895/4096)^2+b*(qx^2+2580733620555895/4096)^2)^3*(1/15/(1/250*qx^2+5285342454898473/2097152)*(a*(qx^2+2580733620555895/4096)^2+b*(qx^2+2580733620555895/4096)^2)+exp(-1/15/(1/250*qx^2+5285342454898473/2097152)*(a*(qx^2+2580733620555895/4096)^2+b*(qx^2+2580733620555895/4096)^2))-1)+4508621084901342414678460521811/174224571863520493293247799005065324265472*(1/250*qx^2+4699980831490119/1048576)^3/(a*(qx^2+4589825030752069/4096)^2+b*(qx^2+4589825030752069/4096)^2)^3*(1/15/(1/250*qx^2+4699980831490119/1048576)*(a*(qx^2+4589825030752069/4096)^2+b*(qx^2+4589825030752069/4096)^2)+exp(-1/15/(1/250*qx^2+4699980831490119/1048576)*(a*(qx^2+4589825030752069/4096)^2+b*(qx^2+4589825030752069/4096)^2))-1)+2220573794181307698285293642039/174224571863520493293247799005065324265472*(1/250*qx^2+1256835255665129/262144)^3/(a*(qx^2+2454756358720955/2048)^2+b*(qx^2+2454756358720955/2048)^2)^3*(1/15/(1/250*qx^2+1256835255665129/262144)*(a*(qx^2+2454756358720955/2048)^2+b*(qx^2+2454756358720955/2048)^2)+exp(-1/15/(1/250*qx^2+1256835255665129/262144)*(a*(qx^2+2454756358720955/2048)^2+b*(qx^2+2454756358720955/2048)^2))-1)+1186198015418873941239837315773/43556142965880123323311949751266331066368*(1/250*qx^2+1920603722457555/524288)^3/(a*(qx^2+234448696589057/256)^2+b*(qx^2+234448696589057/256)^2)^3*(1/15/(1/250*qx^2+1920603722457555/524288)*(a*(qx^2+234448696589057/256)^2+b*(qx^2+234448696589057/256)^2)+exp(-1/15/(1/250*qx^2+1920603722457555/524288)*(a*(qx^2+234448696589057/256)^2+b*(qx^2+234448696589057/256)^2))-1)','ind','qx','Levenberg-Marquardt')

% coeffnames(ftype)
% options.StartPoint = [0.37e-09 1e-020];
% opts = fitoptions('ftype');
% opts.Lower = [1e-11 1e-23]; 
%opts = fitoptions('ftype','StartPoint','1e-009','1e-019')
[fresult,gof,output] = fit(qx,fluct,ftype,'StartPoint',[2.86e-007 2.86e-20],'MaxIter',500)%,'Lower',[0.37e-09 1e-021],'Upper',[0.37e-08 1e-020])
f=feval(fresult,qx)
figure(3)
%semilogy(qx,f,'-*k',qx,fluct,'o','MarkerSize',5,'MarkerEdgeColor','Black')
plot(qx,f,'-*k',qx,fluct,'o','MarkerSize',5,'MarkerEdgeColor','Black')
axis square
kapa1=fresult.b./(1.3806e-23.*296.15)
text(0.7e006,9e-21,texlabel(['kapa= ' num2str(kapa1)]))
text(0.7e006,7e-21,texlabel(['sigma= ' num2str(fresult.a)]))
text(0.7e006,5e-21,texlabel(['ajuste= ' num2str(gof.rsquare)]))
gof
fresult.a
output

